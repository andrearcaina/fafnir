// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: security.sql

package generated

import (
	"context"

	"github.com/google/uuid"
)

const checkUserPermission = `-- name: CheckUserPermission :one
SELECT EXISTS (
    SELECT 1
    FROM users_roles ur
    JOIN roles_permissions rp ON ur.role_name = rp.role_name
    WHERE ur.user_id = $1 AND rp.permission_name = $2
) AS has_permission
`

type CheckUserPermissionParams struct {
	UserID         uuid.UUID `json:"user_id"`
	PermissionName string    `json:"permission_name"`
}

func (q *Queries) CheckUserPermission(ctx context.Context, arg CheckUserPermissionParams) (bool, error) {
	row := q.db.QueryRow(ctx, checkUserPermission, arg.UserID, arg.PermissionName)
	var has_permission bool
	err := row.Scan(&has_permission)
	return has_permission, err
}

const deleteUserRoleWithID = `-- name: DeleteUserRoleWithID :exec
DELETE FROM users_roles
WHERE user_id = $1
`

func (q *Queries) DeleteUserRoleWithID(ctx context.Context, userID uuid.UUID) error {
	_, err := q.db.Exec(ctx, deleteUserRoleWithID, userID)
	return err
}

const insertUserRoleWithID = `-- name: InsertUserRoleWithID :one
INSERT INTO users_roles (user_id, role_name)
VALUES ($1, $2)
RETURNING user_id, role_name
`

type InsertUserRoleWithIDParams struct {
	UserID   uuid.UUID `json:"user_id"`
	RoleName string    `json:"role_name"`
}

type InsertUserRoleWithIDRow struct {
	UserID   uuid.UUID `json:"user_id"`
	RoleName string    `json:"role_name"`
}

// this is for seeding
func (q *Queries) InsertUserRoleWithID(ctx context.Context, arg InsertUserRoleWithIDParams) (InsertUserRoleWithIDRow, error) {
	row := q.db.QueryRow(ctx, insertUserRoleWithID, arg.UserID, arg.RoleName)
	var i InsertUserRoleWithIDRow
	err := row.Scan(&i.UserID, &i.RoleName)
	return i, err
}
